<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>canvas</title>
    <link rel="stylesheet" href="./styles.css">
</head>

<body>
<canvas id="can"></canvas>
<div id="action" class="action">
    <button id="rubber"></button>
    <button id="brush"></button>
</div>



<script>

    const can = document.getElementById('can');
    // 获取全屏宽高
    can.width = document.documentElement.clientWidth

    can.height = document.documentElement.clientHeight
    let painting = false;
    var rubberEnable = false
    var lastPoint = {"x": undefined, "y": undefined}
    const context = can.getContext('2d');
    context.fillStyle = 'green'

    context.strokeStyle = 'green'

    //按下鼠标
    document.onmousedown = function (mousedown) {
        painting = true
        var x = mousedown.clientX
        var y = mousedown.clientY
        if (rubberEnable){
            context.clearRect(x,y,10,10)
        }
        else {
            lastPoint = {"x": x, "y": y}
            drawcircle(x,y,3)
        }
        console.log(lastPoint)

    }
    // 移动鼠标
    document.onmousemove = function (mousemove) {
        let newPoint;
        var x = mousemove.clientX
        var y = mousemove.clientY
        newPoint = {"x": x, "y": y}
        if (painting) {
            if (rubberEnable){
                context.clearRect(x,y,10,10)
            }else {
                connectPoint(lastPoint["x"], lastPoint["y"], newPoint["x"], newPoint["y"])
                lastPoint = newPoint

                drawcircle(x,y,3)
            }
        }

    }
    // 松开鼠标
    document.onmouseup = function (mouseup) {
        painting = false
        console.log('over')

    }
    //画圆
    function drawcircle(x, y, radius) {
        context.beginPath()
        context.arc(x, y, radius, 0, Math.PI * 2)
        context.fill()

    }
    // 链接两点
    function connectPoint(x1,y1,x2,y2) {
        context.beginPath()
        context.lineWidth = 6
        context.moveTo(x1,y1)
        context.lineTo(x2,y2)
        context.closePath()
        context.stroke()

    }


    rubber = document.getElementById('rubber')
    rubber.textContent = '橡皮檫'

    brush = document.getElementById('brush')
    brush.textContent = '画笔'

    rubber.onclick = function () {
        rubberEnable = true
        document.getElementById('action').className = 'actionx'

    }
    brush.onclick = function () {
        rubberEnable = false
        document.getElementById('action').className = 'action'

    }


</script>
</body>

</html>